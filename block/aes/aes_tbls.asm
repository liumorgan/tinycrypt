; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

	TITLE	c:\hub\tinycrypt\block\aes\aes_tbls.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	_gf_mul2
; Function compile flags: /Ogspy
;	COMDAT _gf_mul2
_TEXT	SEGMENT
_w$ = 8							; size = 4
_gf_mul2 PROC						; COMDAT
; File c:\hub\tinycrypt\block\aes\aes_tbls.c
; Line 36
	mov	ecx, DWORD PTR _w$[esp-4]
	and	ecx, -2139062144			; 80808080H
; Line 38
	mov	eax, ecx
	xor	eax, DWORD PTR _w$[esp-4]
	shr	ecx, 7
	imul	ecx, 27					; 0000001bH
	add	eax, eax
	xor	eax, ecx
; Line 39
	ret	0
_gf_mul2 ENDP
_TEXT	ENDS
PUBLIC	_SubWord
; Function compile flags: /Ogspy
;	COMDAT _SubWord
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_x$ = 12						; size = 4
_SubWord PROC						; COMDAT
; Line 47
	push	4
	pop	ecx
	xor	eax, eax
	push	esi
$LL3@SubWord:
; Line 50
	mov	edx, DWORD PTR _x$[esp]
; Line 51
	mov	esi, DWORD PTR _ctx$[esp]
; Line 52
	shr	DWORD PTR _x$[esp], 8
	and	edx, 255				; 000000ffH
	movzx	edx, BYTE PTR [edx+esi+240]
	or	eax, edx
	ror	eax, 8
	dec	ecx
	jne	SHORT $LL3@SubWord
	pop	esi
; Line 55
	ret	0
_SubWord ENDP
_TEXT	ENDS
PUBLIC	_SubBytes
; Function compile flags: /Ogspy
;	COMDAT _SubBytes
_TEXT	SEGMENT
_ctx$ = 8						; size = 4
_state$ = 12						; size = 4
_enc$ = 16						; size = 4
_SubBytes PROC						; COMDAT
; Line 62
	cmp	DWORD PTR _enc$[esp-4], 1
	mov	ecx, DWORD PTR _ctx$[esp-4]
	jne	SHORT $LN6@SubBytes
	add	ecx, 240				; 000000f0H
	jmp	SHORT $LN7@SubBytes
$LN6@SubBytes:
	add	ecx, 496				; 000001f0H
$LN7@SubBytes:
; Line 64
	mov	eax, DWORD PTR _state$[esp-4]
	push	esi
	push	16					; 00000010H
	pop	esi
$LL3@SubBytes:
; Line 65
	movzx	edx, BYTE PTR [eax]
	mov	dl, BYTE PTR [edx+ecx]
	mov	BYTE PTR [eax], dl
	inc	eax
	dec	esi
	jne	SHORT $LL3@SubBytes
	pop	esi
; Line 67
	ret	0
_SubBytes ENDP
_TEXT	ENDS
PUBLIC	_ShiftRows
; Function compile flags: /Ogspy
;	COMDAT _ShiftRows
_TEXT	SEGMENT
tv220 = -4						; size = 4
_state$ = 8						; size = 4
_enc$ = 12						; size = 4
_ShiftRows PROC						; COMDAT
; Line 72
	push	ebp
	mov	ebp, esp
	push	ecx
; Line 75
	mov	edx, DWORD PTR _state$[ebp]
	push	ebx
	push	edi
	xor	edi, edi
	mov	DWORD PTR tv220[ebp], edi
$LL20@ShiftRows:
; Line 76
	xor	eax, eax
; Line 77
	mov	ecx, edi
	cmp	edi, 16					; 00000010H
	jae	SHORT $LN6@ShiftRows
$LL8@ShiftRows:
; Line 79
	movzx	ebx, BYTE PTR [ecx+edx]
	or	eax, ebx
	add	ecx, 4
	ror	eax, 8
	cmp	ecx, 16					; 00000010H
	jb	SHORT $LL8@ShiftRows
$LN6@ShiftRows:
; Line 81
	cmp	DWORD PTR _enc$[ebp], 0
	je	SHORT $LN5@ShiftRows
; Line 82
	push	32					; 00000020H
	pop	ecx
	sub	ecx, DWORD PTR tv220[ebp]
; Line 83
	jmp	SHORT $LN21@ShiftRows
$LN5@ShiftRows:
; Line 84
	mov	ecx, DWORD PTR tv220[ebp]
$LN21@ShiftRows:
	rol	eax, cl
; Line 86
	mov	ecx, edi
	cmp	edi, 16					; 00000010H
	jae	SHORT $LN10@ShiftRows
$LL3@ShiftRows:
; Line 87
	mov	BYTE PTR [ecx+edx], al
	add	ecx, 4
; Line 88
	shr	eax, 8
	cmp	ecx, 16					; 00000010H
	jb	SHORT $LL3@ShiftRows
$LN10@ShiftRows:
; Line 75
	add	DWORD PTR tv220[ebp], 8
	inc	edi
	cmp	DWORD PTR tv220[ebp], 32		; 00000020H
	jb	SHORT $LL20@ShiftRows
	pop	edi
	pop	ebx
; Line 91
	leave
	ret	0
_ShiftRows ENDP
_TEXT	ENDS
PUBLIC	_MixColumn
; Function compile flags: /Ogspy
;	COMDAT _MixColumn
_TEXT	SEGMENT
_w$ = 8							; size = 4
_MixColumn PROC						; COMDAT
; Line 99
	mov	edx, DWORD PTR _w$[esp-4]
	push	esi
	mov	esi, edx
	ror	esi, 8
	mov	eax, esi
	xor	eax, edx
	push	eax
	call	_gf_mul2
	pop	ecx
	mov	ecx, edx
	rol	ecx, 16					; 00000010H
	xor	eax, ecx
	rol	edx, 8
	xor	eax, edx
	xor	eax, esi
	pop	esi
; Line 100
	ret	0
_MixColumn ENDP
_TEXT	ENDS
PUBLIC	_MixColumns
; Function compile flags: /Ogspy
;	COMDAT _MixColumns
_TEXT	SEGMENT
_state$ = 8						; size = 4
_enc$ = 12						; size = 4
_MixColumns PROC					; COMDAT
; Line 103
	push	esi
	push	edi
; Line 106
	xor	edi, edi
$LL4@MixColumns:
; Line 109
	cmp	DWORD PTR _enc$[esp+4], 0
	mov	eax, DWORD PTR _state$[esp+4]
	lea	esi, DWORD PTR [eax+edi*4]
	mov	edx, DWORD PTR [esi]
	jne	SHORT $LN1@MixColumns
; Line 110
	mov	eax, edx
	rol	eax, 16					; 00000010H
	xor	eax, edx
; Line 111
	push	eax
	call	_gf_mul2
	push	eax
	call	_gf_mul2
	pop	ecx
	pop	ecx
; Line 112
	xor	edx, eax
$LN1@MixColumns:
; Line 114
	push	edx
	call	_MixColumn
	inc	edi
	pop	ecx
	mov	DWORD PTR [esi], eax
	cmp	edi, 4
	jb	SHORT $LL4@MixColumns
; Line 116
	pop	edi
	pop	esi
	ret	0
_MixColumns ENDP
_TEXT	ENDS
PUBLIC	_AddRoundKey
; Function compile flags: /Ogspy
;	COMDAT _AddRoundKey
_TEXT	SEGMENT
_state$ = 8						; size = 4
_w$ = 12						; size = 4
_rnd$ = 16						; size = 4
_AddRoundKey PROC					; COMDAT
; Line 123
	mov	eax, DWORD PTR _rnd$[esp-4]
	mov	ecx, DWORD PTR _state$[esp-4]
	shl	eax, 4
	add	eax, DWORD PTR _w$[esp-4]
	push	esi
	push	16					; 00000010H
; Line 125
	sub	eax, ecx
	pop	esi
$LL3@AddRoundKe:
; Line 126
	mov	dl, BYTE PTR [eax+ecx]
	xor	BYTE PTR [ecx], dl
	inc	ecx
	dec	esi
	jne	SHORT $LL3@AddRoundKe
	pop	esi
; Line 128
	ret	0
_AddRoundKey ENDP
_TEXT	ENDS
PUBLIC	_gen_sbox
; Function compile flags: /Ogspy
;	COMDAT _gen_sbox
_TEXT	SEGMENT
_t$ = -1024						; size = 1024
_ctx$ = 8						; size = 4
_gen_sbox PROC						; COMDAT
; Line 133
	push	ebp
	mov	ebp, esp
	sub	esp, 1024				; 00000400H
	push	esi
; Line 137
	xor	edx, edx
	xor	esi, esi
	inc	edx
$LL9@gen_sbox:
; Line 139
	push	edx
	mov	DWORD PTR _t$[ebp+esi*4], edx
	call	_gf_mul2
	xor	edx, eax
	inc	esi
	pop	ecx
	cmp	esi, 256				; 00000100H
	jb	SHORT $LL9@gen_sbox
; Line 142
	mov	esi, DWORD PTR _ctx$[ebp]
	push	ebx
	push	edi
	mov	BYTE PTR [esi+240], 99			; 00000063H
; Line 144
	xor	ecx, ecx
	lea	edi, DWORD PTR _t$[ebp+1020]
$LL6@gen_sbox:
; Line 145
	mov	eax, DWORD PTR [edi]
; Line 146
	mov	edx, eax
	shl	edx, 8
	or	eax, edx
	mov	edx, eax
	shr	edx, 7
	mov	ebx, eax
	shr	ebx, 6
; Line 148
	xor	dl, bl
	mov	ebx, eax
	shr	ebx, 5
	xor	dl, bl
	mov	ebx, eax
	shr	ebx, 4
	xor	dl, bl
	xor	dl, al
	mov	eax, DWORD PTR _t$[ebp+ecx*4]
	xor	dl, 99					; 00000063H
	inc	ecx
	sub	edi, 4
	mov	BYTE PTR [eax+esi+240], dl
	cmp	ecx, 255				; 000000ffH
	jb	SHORT $LL6@gen_sbox
; Line 151
	pop	edi
	xor	eax, eax
	pop	ebx
$LL3@gen_sbox:
; Line 152
	movzx	ecx, BYTE PTR [esi+eax+240]
	mov	BYTE PTR [ecx+esi+496], al
	inc	eax
	cmp	eax, 256				; 00000100H
	jb	SHORT $LL3@gen_sbox
	pop	esi
; Line 154
	leave
	ret	0
_gen_sbox ENDP
_TEXT	ENDS
PUBLIC	_aes_setkey
; Function compile flags: /Ogspy
;	COMDAT _aes_setkey
_TEXT	SEGMENT
_rcon$ = -1						; size = 1
_i$ = 8							; size = 4
_ctx$ = 8						; size = 4
_key$ = 12						; size = 4
_aes_setkey PROC					; COMDAT
; Line 160
	push	ebp
	mov	ebp, esp
	push	ecx
	push	ebx
; Line 167
	mov	ebx, DWORD PTR _ctx$[ebp]
	push	esi
	push	edi
	push	ebx
	mov	BYTE PTR _rcon$[ebp], 1
	call	_gen_sbox
; Line 170
	mov	eax, DWORD PTR _key$[ebp]
	pop	ecx
	push	8
	pop	esi
	mov	ecx, ebx
	sub	eax, ebx
	mov	edx, esi
$LL9@aes_setkey:
; Line 171
	mov	edi, DWORD PTR [eax+ecx]
	mov	DWORD PTR [ecx], edi
	add	ecx, 4
	dec	edx
	jne	SHORT $LL9@aes_setkey
; Line 175
	mov	DWORD PTR _i$[ebp], esi
	mov	esi, ebx
$LL6@aes_setkey:
; Line 178
	mov	eax, DWORD PTR _i$[ebp]
	and	eax, -2147483641			; 80000007H
	mov	edx, DWORD PTR [esi+28]
	jns	SHORT $LN16@aes_setkey
	dec	eax
	or	eax, -8					; fffffff8H
	inc	eax
$LN16@aes_setkey:
	jne	SHORT $LN3@aes_setkey
; Line 180
	movzx	edi, BYTE PTR _rcon$[ebp]
	ror	edx, 8
	push	edx
	push	ebx
	call	_SubWord
	xor	eax, edi
; Line 181
	push	edi
	mov	edx, eax
	call	_gf_mul2
	add	esp, 12					; 0000000cH
	mov	BYTE PTR _rcon$[ebp], al
	jmp	SHORT $LN1@aes_setkey
$LN3@aes_setkey:
; Line 182
	cmp	eax, 4
	jne	SHORT $LN1@aes_setkey
; Line 183
	push	edx
	push	ebx
	call	_SubWord
	pop	ecx
	pop	ecx
	mov	edx, eax
$LN1@aes_setkey:
; Line 185
	mov	eax, DWORD PTR [esi]
	xor	eax, edx
	inc	DWORD PTR _i$[ebp]
	mov	DWORD PTR [esi+32], eax
	add	esi, 4
	cmp	DWORD PTR _i$[ebp], 60			; 0000003cH
	jl	SHORT $LL6@aes_setkey
	pop	edi
	pop	esi
	pop	ebx
; Line 187
	leave
	ret	0
_aes_setkey ENDP
_TEXT	ENDS
PUBLIC	_aes_encrypt
; Function compile flags: /Ogspy
;	COMDAT _aes_encrypt
_TEXT	SEGMENT
tv426 = -4						; size = 4
_ctx$ = 8						; size = 4
_round$ = 11						; size = 1
_state$ = 12						; size = 4
_enc$ = 16						; size = 4
_aes_encrypt PROC					; COMDAT
; Line 192
	push	ebp
	mov	ebp, esp
	push	ecx
; Line 196
	cmp	DWORD PTR _enc$[ebp], 1
	push	ebx
; Line 198
	mov	ebx, DWORD PTR _ctx$[ebp]
	push	esi
	mov	esi, DWORD PTR _state$[ebp]
	push	edi
	push	16					; 00000010H
	mov	eax, esi
	pop	ecx
	jne	SHORT $LN8@aes_encryp
	mov	edi, ebx
	sub	edi, esi
$LL13@aes_encryp:
	mov	dl, BYTE PTR [edi+eax]
	xor	BYTE PTR [eax], dl
	inc	eax
	dec	ecx
	jne	SHORT $LL13@aes_encryp
; Line 200
	add	edi, 16					; 00000010H
	mov	DWORD PTR tv426[ebp], 13		; 0000000dH
	mov	BYTE PTR _round$[ebp], 14		; 0000000eH
$LL51@aes_encryp:
; Line 202
	push	1
	push	esi
	push	ebx
	call	_SubBytes
; Line 203
	push	1
	push	esi
	call	_ShiftRows
; Line 204
	push	1
	push	esi
	call	_MixColumns
	add	esp, 28					; 0000001cH
	push	16					; 00000010H
	mov	eax, esi
	pop	ecx
; Line 205
$LL18@aes_encryp:
	mov	dl, BYTE PTR [edi+eax]
	xor	BYTE PTR [eax], dl
	inc	eax
	dec	ecx
	jne	SHORT $LL18@aes_encryp
; Line 200
	add	edi, 16					; 00000010H
	dec	DWORD PTR tv426[ebp]
	jne	SHORT $LL51@aes_encryp
; Line 208
	jmp	SHORT $LN1@aes_encryp
$LN8@aes_encryp:
; Line 210
	lea	edi, DWORD PTR [ebx+224]
	sub	edi, esi
$LL23@aes_encryp:
	mov	dl, BYTE PTR [edi+eax]
	xor	BYTE PTR [eax], dl
	inc	eax
	dec	ecx
	jne	SHORT $LL23@aes_encryp
; Line 212
	mov	edi, ebx
	sub	edi, esi
	mov	BYTE PTR _round$[ebp], 13		; 0000000dH
	add	edi, 208				; 000000d0H
$LL50@aes_encryp:
; Line 214
	push	DWORD PTR _enc$[ebp]
	push	esi
	call	_ShiftRows
; Line 215
	push	DWORD PTR _enc$[ebp]
	push	esi
	push	ebx
	call	_SubBytes
	add	esp, 20					; 00000014H
	push	16					; 00000010H
	mov	eax, esi
	pop	ecx
; Line 216
$LL28@aes_encryp:
	mov	dl, BYTE PTR [edi+eax]
	xor	BYTE PTR [eax], dl
	inc	eax
	dec	ecx
	jne	SHORT $LL28@aes_encryp
; Line 217
	push	DWORD PTR _enc$[ebp]
	push	esi
	call	_MixColumns
	dec	BYTE PTR _round$[ebp]
	pop	ecx
	sub	edi, 16					; 00000010H
	cmp	BYTE PTR _round$[ebp], 0
	pop	ecx
	ja	SHORT $LL50@aes_encryp
$LN1@aes_encryp:
; Line 220
	push	DWORD PTR _enc$[ebp]
	push	esi
	call	_ShiftRows
; Line 221
	push	DWORD PTR _enc$[ebp]
	push	esi
	push	ebx
	call	_SubBytes
; Line 222
	movzx	eax, BYTE PTR _round$[ebp]
	add	esp, 20					; 00000014H
	shl	eax, 4
	add	eax, ebx
	push	16					; 00000010H
	mov	ecx, esi
	sub	eax, esi
	pop	esi
$LL33@aes_encryp:
	mov	dl, BYTE PTR [eax+ecx]
	xor	BYTE PTR [ecx], dl
	inc	ecx
	dec	esi
	jne	SHORT $LL33@aes_encryp
	pop	edi
	pop	esi
	pop	ebx
; Line 223
	leave
	ret	0
_aes_encrypt ENDP
_TEXT	ENDS
END
